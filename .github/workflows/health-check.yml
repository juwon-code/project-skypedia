# ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ì˜ íŠ¹ì • URLë¡œ ìš”ì²­ì„ ë³´ë‚´ì–´ ë™ì‘ ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” ì›Œí¬í”Œë¡œì…ë‹ˆë‹¤.
# ë§¤ 0ë¶„ì„ ê¸°ì¤€ìœ¼ë¡œ ìë™ìœ¼ë¡œ ë™ì‘í•˜ë©°, ì´ìƒì´ ìˆì„ ê²½ìš° ê´€ë¦¬ìì˜ ìŠ¬ë™ìœ¼ë¡œ ì•Œë¦¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.

name: App Health Check

on:
  schedule:
    - cron: '0 * * * *'

jobs:
  healthcheck:
    runs-on: ubuntu-latest
    steps:
      # ì„œë²„ ì˜¨ë¼ì¸ ìƒíƒœ í™•ì¸
      - name: Check Server Online
        uses: Jtalk/url-health-check-action@v4
        with:
          url: ${{ secrets.SERVER_URL }}
          max-attempts: 3,
          retry-delay: 10s
      # ìŠ¬ë™ ë©”ì‹œì§€ ì „ì†¡ (ì„±ê³µ)
      - name: Send Slack Message on Success
        if: success()
        uses: 8398a7/action-slack@v3.16.2
        with:
          status: success
          text: |
            âœ… *ì„œë²„ í—¬ìŠ¤ ì²´í¬ ì„±ê³µ*
            ì„œë²„ì— API ìš”ì²­ì„ ì‹œë„í•˜ì˜€ìœ¼ë©°, ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒìœ¼ë¡œ í™•ì¸ë©ë‹ˆë‹¤.
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
      # ìŠ¬ë™ ë©”ì‹œì§€ ì „ì†¡ (ì‹¤íŒ¨)
      - name: Send Slack Message on Failure
        if: failure()
        uses: 8398a7/action-slack@v3.16.2
        with:
          status: failure
          text: |
            ğŸš¨ *ì„œë²„ í—¬ìŠ¤ ì²´í¬ ì‹¤íŒ¨*
            ì„œë²„ì— API ìš”ì²­ì„ 3íšŒ ì‹œë„í•˜ì˜€ìœ¼ë‚˜, ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
            ê´€ë¦¬ìë‹˜ê»˜ì„œëŠ” ì›ì¸ì„ íŒŒì•…í•˜ì—¬ ì ì ˆí•œ ì¡°ì¹˜ë¥¼ ì·¨í•´ì£¼ì„¸ìš”.
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
